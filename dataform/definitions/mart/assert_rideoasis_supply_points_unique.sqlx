-- アサーション。最終マートで supply_point_id の重複を検知。
config {
  type: "assertion",
  schema: "rideoasis_mart",
  name: "assert_rideoasis_supply_points_unique"
}

select
  supply_point_id,
  count(*) as duplicate_count
from ${ref("rideoasis_supply_points")}
group by supply_point_id
having count(*) > 1
